<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monad çº¢åŒ… - Web3 DApp</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fade-in-down { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes scale-up { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .animate-fade-in { animation: fade-in 0.2s ease-out; }
        .animate-fade-in-down { animation: fade-in-down 0.3s ease-out; }
        .animate-scale-up { animation: scale-up 0.2s cubic-bezier(0.18, 0.89, 0.32, 1.28); }
        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }
        
        /* é’±åŒ…é€‰æ‹©æ¨¡æ€æ¡†æ ·å¼ */
        .wallet-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Check if ethers is loaded
        if (typeof ethers === 'undefined') {
            console.error('Ethers library failed to load!');
            document.getElementById('root').innerHTML = '<div style="padding: 20px; text-align: center; color: red;"><h1>Error: Ethers library failed to load</h1><p>Please refresh the page or check your internet connection.</p></div>';
            throw new Error('Ethers library is not loaded');
        }

        const { useState, useEffect } = React;

        // Lucide Icons (SVG Components)
        const Wallet = () => (
            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
            </svg>
        );
        const Gift = (props) => (
            <svg className={props.className || "w-6 h-6"} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7" />
            </svg>
        );
        const History = (props) => (
            <svg className={props.className || "w-6 h-6"} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );
        const Send = (props) => (
            <svg className={props.className || "w-5 h-5"} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
            </svg>
        );
        const Lock = (props) => (
            <svg className={props.className || "w-4 h-4"} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
            </svg>
        );
        const Globe = (props) => (
            <svg className={props.className || "w-6 h-6"} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );
        const RefreshCw = (props) => (
            <svg className={props.className || "w-5 h-5"} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
        );
        const CheckCircle = (props) => (
            <svg className={props.className || "w-5 h-5"} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );
        const XCircle = (props) => (
            <svg className={props.className || "w-5 h-5"} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );
        const ChevronRight = (props) => (
            <svg className={props.className || "w-5 h-5"} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
            </svg>
        );

        // --- é…ç½®å¸¸é‡ ---
        const MONAD_CHAIN_ID = 143;
        const MONAD_CHAIN_ID_HEX = '0x8f';
        const RPC_URL = 'https://rpc3.monad.xyz';
        
        // TODO: éƒ¨ç½²åˆçº¦åï¼Œè¯·åœ¨è¿™é‡Œå¡«å†™åˆçº¦åœ°å€
        const CONTRACT_ADDRESS = '0xd4288501bf594eAE9C8093Caa8667C50375E8611'; // è¯·æ›¿æ¢ä¸ºå®é™…éƒ¨ç½²çš„åˆçº¦åœ°å€
        
        // æ™ºèƒ½åˆçº¦ ABI
        const CONTRACT_ABI = [
            "function createPacket(uint256 count, uint8 packetType, uint8 accessType, string memory password) external payable returns (uint256)",
            "function claimPacket(uint256 packetId, string memory password) external",
            "function getPacket(uint256 packetId) external view returns (address sender, uint256 totalAmount, uint256 remainingAmount, uint256 totalCount, uint256 remainingCount, uint8 packetType, uint8 accessType, uint256 timestamp, bool active)",
            "function getPacketClaims(uint256 packetId) external view returns (tuple(address claimer, uint256 amount, uint256 timestamp)[])",
            "function getUserSentPackets(address user) external view returns (uint256[])",
            "function getUserReceivedPackets(address user) external view returns (uint256[])",
            "function getRecentActivePackets(uint256 limit) external view returns (uint256[])",
            "function nextPacketId() external view returns (uint256)",
            "event PacketCreated(uint256 indexed packetId, address indexed sender, uint256 totalAmount, uint256 count, uint8 packetType, uint8 accessType)",
            "event PacketClaimed(uint256 indexed packetId, address indexed claimer, uint256 amount)"
        ];

        // å·¥å…·å‡½æ•°
        const shortenAddress = (addr) => {
            if (!addr) return '';
            return `${addr.substring(0, 6)}...${addr.substring(addr.length - 4)}`;
        };

        function MonadRedPacket() {
            // --- State ç®¡ç† ---
            const [walletAddress, setWalletAddress] = useState('');
            const [balance, setBalance] = useState('0.00');
            const [activeTab, setActiveTab] = useState('home');
            const [loading, setLoading] = useState(false);
            const [notification, setNotification] = useState(null);
            
            const [packets, setPackets] = useState([]);
            const [userHistory, setUserHistory] = useState({ sent: [], received: [] });
            
            const [provider, setProvider] = useState(null);
            const [signer, setSigner] = useState(null);
            const [contract, setContract] = useState(null);
            const [connectedWalletType, setConnectedWalletType] = useState(''); // 'metamask', 'walletconnect', 'coinbase', etc.
            const [showWalletModal, setShowWalletModal] = useState(false);

            const [formData, setFormData] = useState({
                totalAmount: '',
                count: '',
                type: 'random',
                accessType: 'public',
                password: ''
            });

            const [claimPassword, setClaimPassword] = useState('');
            const [selectedPacket, setSelectedPacket] = useState(null);

            // --- Web3 è¿æ¥é€»è¾‘ ---
            
            // æ£€æµ‹å¯ç”¨çš„é’±åŒ…
            const detectWallets = () => {
                const wallets = [];
                
                // MetaMask
                if (typeof window.ethereum !== 'undefined' && window.ethereum.isMetaMask) {
                    wallets.push({ id: 'metamask', name: 'MetaMask', icon: 'ğŸ¦Š' });
                }
                
                // Coinbase Wallet
                if (typeof window.ethereum !== 'undefined' && window.ethereum.isCoinbaseWallet) {
                    wallets.push({ id: 'coinbase', name: 'Coinbase Wallet', icon: 'ğŸ”µ' });
                }
                
                // Trust Wallet
                if (typeof window.ethereum !== 'undefined' && window.ethereum.isTrust) {
                    wallets.push({ id: 'trust', name: 'Trust Wallet', icon: 'â­' });
                }
                
                // Generic injected wallet (if ethereum exists but none of the above)
                if (typeof window.ethereum !== 'undefined' && wallets.length === 0) {
                    wallets.push({ id: 'injected', name: 'é’±åŒ…æ‰©å±•', icon: 'ğŸ’¼' });
                }
                
                // WalletConnect (always available)
                wallets.push({ id: 'walletconnect', name: 'WalletConnect', icon: 'ğŸ“±' });
                
                return wallets;
            };

            // æ˜¾ç¤ºé’±åŒ…é€‰æ‹©æ¨¡æ€æ¡†
            const showWalletSelector = () => {
                const availableWallets = detectWallets();
                if (availableWallets.length === 0) {
                    showNotification('error', 'æœªæ£€æµ‹åˆ°é’±åŒ…ï¼Œè¯·å®‰è£… MetaMask æˆ–å…¶ä»– Web3 é’±åŒ…');
                    return;
                }
                setShowWalletModal(true);
            };

            // ä½¿ç”¨æŒ‡å®šé’±åŒ…è¿æ¥
            const connectWithWallet = async (walletType) => {
                setShowWalletModal(false);
                setLoading(true);
                
                try {
                    let web3Provider;
                    
                    if (walletType === 'walletconnect') {
                        // WalletConnect
                        const WalletConnectProvider = window.WalletConnectProvider.default;
                        const wcProvider = new WalletConnectProvider({
                            rpc: {
                                [MONAD_CHAIN_ID]: RPC_URL,
                            },
                            chainId: MONAD_CHAIN_ID,
                        });
                        
                        await wcProvider.enable();
                        web3Provider = new ethers.providers.Web3Provider(wcProvider);
                    } else {
                        // Injected wallets (MetaMask, Coinbase, Trust, etc.)
                        if (typeof window.ethereum === 'undefined') {
                            showNotification('error', 'æœªæ£€æµ‹åˆ°é’±åŒ…æ‰©å±•');
                            setLoading(false);
                            return;
                        }
                        
                        await window.ethereum.request({ method: 'eth_requestAccounts' });
                        web3Provider = new ethers.providers.Web3Provider(window.ethereum);
                    }
                    
                    // è·å–åœ°å€
                    const web3Signer = web3Provider.getSigner();
                    const address = await web3Signer.getAddress();
                    setWalletAddress(address);
                    setSigner(web3Signer);
                    setProvider(web3Provider);
                    setConnectedWalletType(walletType);
                    
                    // æ£€æŸ¥å¹¶åˆ‡æ¢ç½‘ç»œ (ä»…å¯¹æ”¯æŒçš„é’±åŒ…)
                    if (walletType !== 'walletconnect') {
                        try {
                            await window.ethereum.request({
                                method: 'wallet_switchEthereumChain',
                                params: [{ chainId: MONAD_CHAIN_ID_HEX }],
                            });
                        } catch (switchError) {
                            if (switchError.code === 4902) {
                                try {
                                    await window.ethereum.request({
                                        method: 'wallet_addEthereumChain',
                                        params: [{
                                            chainId: MONAD_CHAIN_ID_HEX,
                                            chainName: 'Monad Testnet',
                                            rpcUrls: [RPC_URL],
                                            nativeCurrency: {
                                                name: 'MON',
                                                symbol: 'MON',
                                                decimals: 18,
                                            },
                                        }],
                                    });
                                } catch (addError) {
                                    showNotification('error', 'æ·»åŠ  Monad ç½‘ç»œå¤±è´¥');
                                    setLoading(false);
                                    return;
                                }
                            }
                        }
                    }

                    // åˆå§‹åŒ–åˆçº¦
                    const redPacketContract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, web3Signer);
                    setContract(redPacketContract);

                    // è·å–ä½™é¢
                    const bal = await web3Provider.getBalance(address);
                    setBalance(ethers.utils.formatEther(bal));

                    showNotification('success', 'é’±åŒ…è¿æ¥æˆåŠŸ');
                    
                    // åŠ è½½æ•°æ®
                    await loadPackets(redPacketContract);
                    await loadUserHistory(redPacketContract, address);

                } catch (error) {
                    console.error('é’±åŒ…è¿æ¥é”™è¯¯:', error);
                    showNotification('error', error.message || 'è¿æ¥è¢«æ‹’ç»');
                } finally {
                    setLoading(false);
                }
            };

            // æ–­å¼€é’±åŒ…è¿æ¥
            const disconnectWallet = async () => {
                if (connectedWalletType === 'walletconnect' && provider && provider.provider && provider.provider.disconnect) {
                    await provider.provider.disconnect();
                }
                
                setWalletAddress('');
                setBalance('0.00');
                setProvider(null);
                setSigner(null);
                setContract(null);
                setConnectedWalletType('');
                setPackets([]);
                setUserHistory({ sent: [], received: [] });
                
                showNotification('success', 'é’±åŒ…å·²æ–­å¼€');
            };

            // åŠ è½½çº¢åŒ…åˆ—è¡¨
            const loadPackets = async (contractInstance) => {
                try {
                    const packetIds = await contractInstance.getRecentActivePackets(50);
                    const packetPromises = packetIds.map(async (id) => {
                        const packet = await contractInstance.getPacket(id);
                        return {
                            id: id.toString(),
                            sender: packet.sender,
                            totalAmount: ethers.utils.formatEther(packet.totalAmount),
                            remainingAmount: ethers.utils.formatEther(packet.remainingAmount),
                            totalCount: packet.totalCount.toNumber(),
                            remainingCount: packet.remainingCount.toNumber(),
                            type: packet.packetType === 0 ? 'random' : 'equal',
                            accessType: packet.accessType === 0 ? 'public' : 'password',
                            timestamp: new Date(packet.timestamp.toNumber() * 1000).toISOString(),
                            active: packet.active
                        };
                    });
                    const loadedPackets = await Promise.all(packetPromises);
                    setPackets(loadedPackets);
                } catch (error) {
                    console.error('åŠ è½½çº¢åŒ…å¤±è´¥:', error);
                }
            };

            // åŠ è½½ç”¨æˆ·å†å²
            const loadUserHistory = async (contractInstance, address) => {
                try {
                    // åŠ è½½å‘é€çš„çº¢åŒ…
                    const sentIds = await contractInstance.getUserSentPackets(address);
                    const sentPromises = sentIds.map(async (id) => {
                        const packet = await contractInstance.getPacket(id);
                        return {
                            id: id.toString(),
                            sender: packet.sender,
                            totalAmount: ethers.utils.formatEther(packet.totalAmount),
                            remainingAmount: ethers.utils.formatEther(packet.remainingAmount),
                            totalCount: packet.totalCount.toNumber(),
                            remainingCount: packet.remainingCount.toNumber(),
                            type: packet.packetType === 0 ? 'random' : 'equal',
                            accessType: packet.accessType === 0 ? 'public' : 'password',
                            timestamp: new Date(packet.timestamp.toNumber() * 1000).toISOString()
                        };
                    });
                    const sent = await Promise.all(sentPromises);

                    // åŠ è½½é¢†å–çš„çº¢åŒ…
                    const receivedIds = await contractInstance.getUserReceivedPackets(address);
                    const receivedPromises = receivedIds.map(async (id) => {
                        const packet = await contractInstance.getPacket(id);
                        const claims = await contractInstance.getPacketClaims(id);
                        const userClaim = claims.find(c => c.claimer.toLowerCase() === address.toLowerCase());
                        
                        return {
                            packetId: id.toString(),
                            sender: packet.sender,
                            amount: userClaim ? ethers.utils.formatEther(userClaim.amount) : '0',
                            timestamp: userClaim ? new Date(userClaim.timestamp.toNumber() * 1000) : new Date()
                        };
                    });
                    const received = await Promise.all(receivedPromises);

                    setUserHistory({ sent, received });
                } catch (error) {
                    console.error('åŠ è½½å†å²å¤±è´¥:', error);
                }
            };

            // åˆ›å»ºçº¢åŒ…
            const handleCreatePacket = async () => {
                if (!walletAddress) return showNotification('error', 'è¯·å…ˆè¿æ¥é’±åŒ…');
                if (!contract) return showNotification('error', 'åˆçº¦æœªåˆå§‹åŒ–');
                if (!formData.totalAmount || !formData.count) return showNotification('error', 'è¯·å¡«å†™å®Œæ•´ä¿¡æ¯');
                
                const amount = parseFloat(formData.totalAmount);
                const count = parseInt(formData.count);
                
                if (amount <= 0) return showNotification('error', 'é‡‘é¢å¿…é¡»å¤§äº0');
                if (count <= 0 || count > 100) return showNotification('error', 'çº¢åŒ…æ•°é‡å¿…é¡»åœ¨1-100ä¹‹é—´');
                if (amount > parseFloat(balance)) return showNotification('error', 'ä½™é¢ä¸è¶³');

                setLoading(true);
                try {
                    const packetType = formData.type === 'random' ? 0 : 1;
                    const accessType = formData.accessType === 'public' ? 0 : 1;
                    const password = formData.password || '';
                    
                    const amountWei = ethers.utils.parseEther(amount.toString());
                    
                    const tx = await contract.createPacket(
                        count,
                        packetType,
                        accessType,
                        password,
                        { value: amountWei }
                    );
                    
                    showNotification('success', 'äº¤æ˜“å·²æäº¤ï¼Œç­‰å¾…ç¡®è®¤...');
                    await tx.wait();
                    
                    showNotification('success', 'çº¢åŒ…å‘é€æˆåŠŸï¼');
                    
                    // é‡æ–°åŠ è½½æ•°æ®
                    await loadPackets(contract);
                    await loadUserHistory(contract, walletAddress);
                    
                    // æ›´æ–°ä½™é¢
                    const bal = await provider.getBalance(walletAddress);
                    setBalance(ethers.utils.formatEther(bal));
                    
                    // é‡ç½®è¡¨å•
                    setFormData({ 
                        totalAmount: '', 
                        count: '', 
                        type: 'random', 
                        accessType: 'public', 
                        password: '' 
                    });
                    setActiveTab('home');
                    
                } catch (error) {
                    console.error('åˆ›å»ºçº¢åŒ…å¤±è´¥:', error);
                    showNotification('error', error.reason || error.message || 'åˆ›å»ºçº¢åŒ…å¤±è´¥');
                } finally {
                    setLoading(false);
                }
            };

            // é¢†å–çº¢åŒ…
            const handleClaimPacket = async (packetId, passwordInput = '') => {
                if (!walletAddress) return showNotification('error', 'è¯·å…ˆè¿æ¥é’±åŒ…');
                if (!contract) return showNotification('error', 'åˆçº¦æœªåˆå§‹åŒ–');

                setLoading(true);
                try {
                    const tx = await contract.claimPacket(packetId, passwordInput);
                    
                    showNotification('success', 'äº¤æ˜“å·²æäº¤ï¼Œç­‰å¾…ç¡®è®¤...');
                    const receipt = await tx.wait();
                    
                    // ä»äº‹ä»¶ä¸­è·å–é¢†å–é‡‘é¢
                    const claimEvent = receipt.events?.find(e => e.event === 'PacketClaimed');
                    let claimAmount = '0';
                    if (claimEvent) {
                        claimAmount = ethers.utils.formatEther(claimEvent.args.amount);
                    }
                    
                    showNotification('success', `æˆåŠŸæŠ¢åˆ° ${claimAmount} MON`);
                    
                    // é‡æ–°åŠ è½½æ•°æ®
                    await loadPackets(contract);
                    await loadUserHistory(contract, walletAddress);
                    
                    // æ›´æ–°ä½™é¢
                    const bal = await provider.getBalance(walletAddress);
                    setBalance(ethers.utils.formatEther(bal));
                    
                    setSelectedPacket(null);
                    setClaimPassword('');
                    
                } catch (error) {
                    console.error('é¢†å–çº¢åŒ…å¤±è´¥:', error);
                    let errorMsg = 'é¢†å–çº¢åŒ…å¤±è´¥';
                    if (error.reason) {
                        errorMsg = error.reason;
                    } else if (error.message) {
                        if (error.message.includes('Already claimed')) errorMsg = 'ä½ å·²ç»é¢†å–è¿‡è¯¥çº¢åŒ…äº†';
                        else if (error.message.includes('Packet is empty')) errorMsg = 'æ‰‹æ…¢äº†ï¼Œçº¢åŒ…å·²æŠ¢å®Œ';
                        else if (error.message.includes('Wrong password')) errorMsg = 'å£ä»¤é”™è¯¯';
                        else if (error.message.includes('Sender cannot claim')) errorMsg = 'ä¸èƒ½é¢†å–è‡ªå·±çš„çº¢åŒ…';
                    }
                    showNotification('error', errorMsg);
                } finally {
                    setLoading(false);
                }
            };

            // è‡ªåŠ¨åˆ·æ–°
            useEffect(() => {
                if (contract && walletAddress) {
                    const interval = setInterval(async () => {
                        await loadPackets(contract);
                    }, 10000); // æ¯10ç§’åˆ·æ–°ä¸€æ¬¡
                    
                    return () => clearInterval(interval);
                }
            }, [contract, walletAddress]);

            // ç›‘å¬è´¦æˆ·å˜åŒ–
            useEffect(() => {
                if (window.ethereum && connectedWalletType !== 'walletconnect') {
                    const handleAccountsChanged = (accounts) => {
                        if (accounts.length === 0) {
                            disconnectWallet();
                        } else if (accounts[0].toLowerCase() !== walletAddress.toLowerCase()) {
                            // è´¦æˆ·åˆ‡æ¢ï¼Œé‡æ–°è¿æ¥
                            if (connectedWalletType) {
                                connectWithWallet(connectedWalletType);
                            }
                        }
                    };

                    const handleChainChanged = () => {
                        window.location.reload();
                    };

                    window.ethereum.on('accountsChanged', handleAccountsChanged);
                    window.ethereum.on('chainChanged', handleChainChanged);

                    return () => {
                        if (window.ethereum.removeListener) {
                            window.ethereum.removeListener('accountsChanged', handleAccountsChanged);
                            window.ethereum.removeListener('chainChanged', handleChainChanged);
                        }
                    };
                }
            }, [connectedWalletType, walletAddress]);

            // ç›‘å¬ WalletConnect æ–­å¼€è¿æ¥
            useEffect(() => {
                if (connectedWalletType === 'walletconnect' && provider && provider.provider) {
                    const handleDisconnect = () => {
                        disconnectWallet();
                    };

                    provider.provider.on('disconnect', handleDisconnect);

                    return () => {
                        if (provider.provider.removeListener) {
                            provider.provider.removeListener('disconnect', handleDisconnect);
                        }
                    };
                }
            }, [connectedWalletType, provider]);

            const showNotification = (type, msg) => {
                setNotification({ type, msg });
                setTimeout(() => setNotification(null), 5000);
            };

            return (
                <div className="min-h-screen bg-gray-50 text-gray-800 font-sans pb-20 md:pb-0">
                    
                    {/* é¡¶éƒ¨å¯¼èˆª */}
                    <header className="bg-gradient-to-r from-red-600 to-red-500 text-white p-4 shadow-lg sticky top-0 z-50">
                        <div className="max-w-4xl mx-auto flex justify-between items-center">
                            <div className="flex items-center space-x-2">
                                <Gift className="w-6 h-6 animate-bounce" />
                                <h1 className="text-xl font-bold tracking-wider">Monad çº¢åŒ…</h1>
                            </div>
                            
                            {walletAddress ? (
                                <div className="flex items-center space-x-2">
                                    <div className="flex items-center space-x-2 bg-red-700 bg-opacity-40 px-3 py-1.5 rounded-full border border-red-400">
                                        <span className="text-xs md:text-sm font-mono text-yellow-300 font-bold">{parseFloat(balance).toFixed(4)} MON</span>
                                        <div className="h-4 w-[1px] bg-red-300"></div>
                                        <span className="text-xs md:text-sm truncate max-w-[80px] md:max-w-none">{shortenAddress(walletAddress)}</span>
                                    </div>
                                    <button 
                                        onClick={disconnectWallet}
                                        className="bg-red-700 bg-opacity-40 px-2 py-1.5 rounded-full border border-red-400 hover:bg-red-800 transition"
                                        title="æ–­å¼€é’±åŒ…"
                                    >
                                        <XCircle className="w-4 h-4" />
                                    </button>
                                </div>
                            ) : (
                                <button 
                                    onClick={showWalletSelector}
                                    disabled={loading}
                                    className="flex items-center space-x-1 bg-white text-red-600 px-4 py-1.5 rounded-full text-sm font-bold shadow-sm hover:bg-gray-100 transition disabled:opacity-50"
                                >
                                    <Wallet />
                                    <span>è¿æ¥é’±åŒ…</span>
                                </button>
                            )}
                        </div>
                    </header>

                    {/* é€šçŸ¥ Toast */}
                    {notification && (
                        <div className={`fixed top-20 right-4 left-4 md:left-auto md:w-96 z-50 px-4 py-3 rounded-lg shadow-xl flex items-center space-x-2 animate-fade-in-down ${
                            notification.type === 'success' ? 'bg-green-50 text-green-700 border border-green-200' : 'bg-red-50 text-red-700 border border-red-200'
                        }`}>
                            {notification.type === 'success' ? <CheckCircle /> : <XCircle />}
                            <span className="text-sm font-medium flex-1">{notification.msg}</span>
                        </div>
                    )}

                    {/* ä¸»å†…å®¹åŒº */}
                    <main className="max-w-3xl mx-auto p-4 space-y-6">
                        
                        {/* çº¢åŒ…å¤§å… */}
                        {activeTab === 'home' && (
                            <div className="space-y-4">
                                <div className="flex justify-between items-end">
                                    <h2 className="text-2xl font-bold text-gray-800">çº¢åŒ…å¤§å…</h2>
                                    <span className="text-xs text-gray-500 bg-gray-200 px-2 py-1 rounded">ChainId: {MONAD_CHAIN_ID}</span>
                                </div>

                                {!walletAddress ? (
                                    <div className="text-center py-20 bg-white rounded-2xl shadow-sm border border-gray-100">
                                        <div className="bg-red-50 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                                            <Wallet />
                                        </div>
                                        <p className="text-gray-600 mb-4">è¯·å…ˆè¿æ¥é’±åŒ…</p>
                                        <button 
                                            onClick={showWalletSelector}
                                            className="bg-red-600 text-white px-6 py-2 rounded-full font-bold hover:bg-red-700 transition"
                                        >
                                            è¿æ¥é’±åŒ…
                                        </button>
                                    </div>
                                ) : packets.length === 0 ? (
                                    <div className="text-center py-20 bg-white rounded-2xl shadow-sm border border-gray-100">
                                        <div className="bg-red-50 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                                            <Gift className="w-10 h-10 text-red-300" />
                                        </div>
                                        <p className="text-gray-400">æš‚æ— çº¢åŒ…ï¼Œå¿«å»å‘ä¸€ä¸ªå§ï¼</p>
                                        <button 
                                            onClick={() => setActiveTab('send')}
                                            className="mt-4 text-red-600 font-medium hover:underline"
                                        >
                                            å»å‘çº¢åŒ… &rarr;
                                        </button>
                                    </div>
                                ) : (
                                    <div className="grid gap-4 md:grid-cols-2">
                                        {packets.map((packet) => {
                                            const isFinished = packet.remainingCount === 0;
                                            const isSender = packet.sender.toLowerCase() === walletAddress.toLowerCase();

                                            return (
                                                <div key={packet.id} className={`relative bg-white p-5 rounded-2xl shadow-sm border transition hover:shadow-md ${isFinished ? 'border-gray-200 opacity-60' : 'border-red-100'}`}>
                                                    <div className="absolute top-0 right-0">
                                                        {packet.type === 'random' ? (
                                                            <span className="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-bl-lg rounded-tr-lg font-medium">æ‹¼æ‰‹æ°”</span>
                                                        ) : (
                                                            <span className="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-bl-lg rounded-tr-lg font-medium">æ™®é€š</span>
                                                        )}
                                                    </div>

                                                    <div className="flex items-start space-x-3">
                                                        <div className={`p-3 rounded-full flex-shrink-0 ${isFinished ? 'bg-gray-100' : 'bg-red-50'}`}>
                                                            {packet.accessType === 'password' ? <Lock className="w-6 h-6 text-red-500"/> : <Globe className="w-6 h-6 text-red-500"/>}
                                                        </div>
                                                        <div className="flex-1 min-w-0">
                                                            <p className="text-xs text-gray-500 truncate">å‘é€è€…: {shortenAddress(packet.sender)}</p>
                                                            <p className="text-lg font-bold text-gray-800 mt-1">
                                                                {isFinished ? 'å·²æŠ¢å®Œ' : packet.accessType === 'password' ? 'å£ä»¤çº¢åŒ…' : 'å…¬å…±çº¢åŒ…'}
                                                            </p>
                                                            <div className="mt-3 flex items-center justify-between text-sm">
                                                                <span className="text-gray-500">å‰©ä½™: <span className="text-red-600 font-bold">{packet.remainingCount}</span>/{packet.totalCount}</span>
                                                                
                                                                {isSender ? (
                                                                    <span className="text-blue-600 font-medium bg-blue-50 px-2 py-1 rounded text-xs">æˆ‘å‘çš„</span>
                                                                ) : isFinished ? (
                                                                    <span className="text-gray-400 text-xs">æ‰‹æ…¢äº†</span>
                                                                ) : (
                                                                    <button 
                                                                        onClick={() => {
                                                                            if (packet.accessType === 'public') {
                                                                                handleClaimPacket(packet.id);
                                                                            } else {
                                                                                setSelectedPacket(packet);
                                                                            }
                                                                        }}
                                                                        disabled={loading}
                                                                        className="bg-red-500 hover:bg-red-600 text-white px-3 py-1.5 rounded-full text-xs font-bold transition shadow-sm disabled:bg-gray-400"
                                                                    >
                                                                        {packet.accessType === 'password' ? 'è¾“å…¥å£ä»¤' : 'ç«‹å³å¼€æŠ¢'}
                                                                    </button>
                                                                )}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>
                                )}
                            </div>
                        )}

                        {/* å‘çº¢åŒ… */}
                        {activeTab === 'send' && (
                            <div className="bg-white rounded-2xl shadow-lg border border-red-100 overflow-hidden">
                                <div className="bg-red-50 p-6 border-b border-red-100">
                                    <h2 className="text-xl font-bold text-red-900 flex items-center">
                                        <Send className="mr-2" /> å‘é€çº¢åŒ…
                                    </h2>
                                    <p className="text-sm text-red-700 mt-1">å°† MON å‘é€ç»™æœ‹å‹æˆ–ç¾¤ç»„</p>
                                </div>
                                
                                <div className="p-6 space-y-5">
                                    {/* æ¨¡å¼é€‰æ‹© */}
                                    <div className="grid grid-cols-2 gap-3">
                                        <button
                                            onClick={() => setFormData({...formData, type: 'random'})}
                                            className={`p-3 rounded-xl border flex flex-col items-center justify-center transition ${formData.type === 'random' ? 'border-red-500 bg-red-50 text-red-700' : 'border-gray-200 text-gray-500 hover:bg-gray-50'}`}
                                        >
                                            <RefreshCw className="mb-1" />
                                            <span className="text-sm font-bold">æ‹¼æ‰‹æ°”</span>
                                        </button>
                                        <button
                                            onClick={() => setFormData({...formData, type: 'equal'})}
                                            className={`p-3 rounded-xl border flex flex-col items-center justify-center transition ${formData.type === 'equal' ? 'border-red-500 bg-red-50 text-red-700' : 'border-gray-200 text-gray-500 hover:bg-gray-50'}`}
                                        >
                                            <CheckCircle className="mb-1" />
                                            <span className="text-sm font-bold">æ™®é€šå‡åˆ†</span>
                                        </button>
                                    </div>

                                    {/* é‡‘é¢è¾“å…¥ */}
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">æ€»é‡‘é¢ (MON)</label>
                                        <div className="relative">
                                            <input 
                                                type="number" 
                                                step="0.001"
                                                placeholder="0.00"
                                                value={formData.totalAmount}
                                                onChange={(e) => setFormData({...formData, totalAmount: e.target.value})}
                                                className="w-full pl-4 pr-12 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-red-500 focus:outline-none transition"
                                            />
                                            <span className="absolute right-4 top-3.5 text-gray-400 font-bold text-sm">MON</span>
                                        </div>
                                    </div>

                                    {/* æ•°é‡è¾“å…¥ */}
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">çº¢åŒ…ä¸ªæ•° (1-100)</label>
                                        <div className="relative">
                                            <input 
                                                type="number" 
                                                placeholder="å¡«å†™ä¸ªæ•°"
                                                min="1"
                                                max="100"
                                                value={formData.count}
                                                onChange={(e) => setFormData({...formData, count: e.target.value})}
                                                className="w-full pl-4 pr-12 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-red-500 focus:outline-none transition"
                                            />
                                            <span className="absolute right-4 top-3.5 text-gray-400 font-bold text-sm">ä¸ª</span>
                                        </div>
                                    </div>

                                    {/* è®¿é—®æ§åˆ¶ */}
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">é¢†å–æ–¹å¼</label>
                                        <div className="flex space-x-4">
                                            <label className="flex items-center cursor-pointer">
                                                <input 
                                                    type="radio" 
                                                    name="accessType"
                                                    checked={formData.accessType === 'public'}
                                                    onChange={() => setFormData({...formData, accessType: 'public'})}
                                                    className="text-red-600 focus:ring-red-500"
                                                />
                                                <span className="ml-2 text-sm text-gray-700">å…¬å…±å¯è§</span>
                                            </label>
                                            <label className="flex items-center cursor-pointer">
                                                <input 
                                                    type="radio" 
                                                    name="accessType"
                                                    checked={formData.accessType === 'password'}
                                                    onChange={() => setFormData({...formData, accessType: 'password'})}
                                                    className="text-red-600 focus:ring-red-500"
                                                />
                                                <span className="ml-2 text-sm text-gray-700">å£ä»¤ä¿æŠ¤</span>
                                            </label>
                                        </div>
                                    </div>

                                    {/* å£ä»¤è¾“å…¥ */}
                                    {formData.accessType === 'password' && (
                                        <div className="animate-fade-in">
                                            <label className="block text-sm font-medium text-gray-700 mb-1">è®¾ç½®å£ä»¤</label>
                                            <div className="relative">
                                                <Lock className="absolute left-3 top-3.5 text-gray-400 w-4 h-4" />
                                                <input 
                                                    type="text" 
                                                    placeholder="é¢†å–çš„æš—å·"
                                                    value={formData.password}
                                                    onChange={(e) => setFormData({...formData, password: e.target.value})}
                                                    className="w-full pl-10 pr-4 py-3 bg-red-50 border border-red-100 rounded-xl focus:ring-2 focus:ring-red-500 focus:outline-none transition"
                                                />
                                            </div>
                                        </div>
                                    )}

                                    <div className="pt-4">
                                        <button 
                                            onClick={handleCreatePacket}
                                            disabled={loading || !walletAddress}
                                            className={`w-full py-3.5 rounded-xl font-bold text-white shadow-lg transform transition active:scale-95 ${loading || !walletAddress ? 'bg-gray-300 cursor-not-allowed' : 'bg-red-600 hover:bg-red-700 hover:shadow-red-200'}`}
                                        >
                                            {loading ? 'å¤„ç†ä¸­...' : (formData.totalAmount ? `å¡è¿›çº¢åŒ… ${formData.totalAmount} MON` : 'å‡†å¤‡å‘çº¢åŒ…')}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* å†å²è®°å½• */}
                        {activeTab === 'history' && (
                            <div className="space-y-6">
                                {/* ç»Ÿè®¡æ¦‚è§ˆ */}
                                <div className="grid grid-cols-2 gap-4">
                                    <div className="bg-white p-4 rounded-2xl shadow-sm border border-gray-100">
                                        <p className="text-xs text-gray-500 mb-1">æˆ‘å‘å‡ºçš„</p>
                                        <p className="text-2xl font-bold text-gray-800">{userHistory.sent.length} <span className="text-sm font-normal text-gray-400">ä¸ª</span></p>
                                    </div>
                                    <div className="bg-white p-4 rounded-2xl shadow-sm border border-gray-100">
                                        <p className="text-xs text-gray-500 mb-1">æˆ‘æŠ¢åˆ°çš„</p>
                                        <div className="flex items-baseline space-x-1">
                                            <p className="text-2xl font-bold text-red-600">
                                                {userHistory.received.reduce((acc, cur) => acc + parseFloat(cur.amount), 0).toFixed(4)}
                                            </p>
                                            <span className="text-xs font-medium text-gray-400">MON</span>
                                        </div>
                                    </div>
                                </div>

                                <div className="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                                    <div className="px-5 py-4 border-b border-gray-100">
                                        <h3 className="font-bold text-gray-800">é¢†å–è®°å½•æ˜ç»†</h3>
                                    </div>
                                    {userHistory.received.length === 0 ? (
                                        <div className="p-8 text-center text-gray-400 text-sm">æš‚æ— é¢†å–è®°å½•</div>
                                    ) : (
                                        <ul>
                                            {userHistory.received.map((item, idx) => (
                                                <li key={idx} className="px-5 py-3 border-b border-gray-50 last:border-0 flex justify-between items-center hover:bg-gray-50 transition">
                                                    <div>
                                                        <p className="text-sm font-bold text-gray-800">æ¥è‡ª: {shortenAddress(item.sender)}</p>
                                                        <p className="text-xs text-gray-400">{new Date(item.timestamp).toLocaleString()}</p>
                                                    </div>
                                                    <div className="text-right">
                                                        <span className="block text-red-600 font-bold">+{parseFloat(item.amount).toFixed(4)} MON</span>
                                                        <span className="text-xs text-green-600 bg-green-50 px-1 rounded">å·²å…¥è´¦</span>
                                                    </div>
                                                </li>
                                            ))}
                                        </ul>
                                    )}
                                </div>
                                
                                <div className="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                                    <div className="px-5 py-4 border-b border-gray-100">
                                        <h3 className="font-bold text-gray-800">å‘é€è®°å½•</h3>
                                    </div>
                                    {userHistory.sent.length === 0 ? (
                                        <div className="p-8 text-center text-gray-400 text-sm">æš‚æ— å‘é€è®°å½•</div>
                                    ) : (
                                        <ul>
                                            {userHistory.sent.map((item, idx) => (
                                                <li key={idx} className="px-5 py-3 border-b border-gray-50 last:border-0 flex justify-between items-center hover:bg-gray-50 transition">
                                                    <div>
                                                        <p className="text-sm font-bold text-gray-800">
                                                            {item.type === 'random' ? 'æ‹¼æ‰‹æ°”' : 'æ™®é€š'}çº¢åŒ… 
                                                            {item.accessType === 'password' && <Lock className="inline w-3 h-3 ml-1 text-gray-400"/>}
                                                        </p>
                                                        <p className="text-xs text-gray-400">{new Date(item.timestamp).toLocaleString()}</p>
                                                    </div>
                                                    <div className="text-right">
                                                        <span className="block text-gray-800 font-bold">-{item.totalAmount} MON</span>
                                                        <span className="text-xs text-gray-500">å·²é¢† {item.totalCount - item.remainingCount}/{item.totalCount}</span>
                                                    </div>
                                                </li>
                                            ))}
                                        </ul>
                                    )}
                                </div>
                            </div>
                        )}
                    </main>

                    {/* åº•éƒ¨å¯¼èˆª (Mobile) */}
                    <div className="fixed bottom-0 w-full bg-white border-t border-gray-200 py-2 flex justify-around items-center md:hidden z-40 pb-safe">
                        <button onClick={() => setActiveTab('home')} className={`flex flex-col items-center space-y-1 ${activeTab === 'home' ? 'text-red-600' : 'text-gray-400'}`}>
                            <Gift className="w-6 h-6" />
                            <span className="text-xs scale-90">æŠ¢çº¢åŒ…</span>
                        </button>
                        <button onClick={() => setActiveTab('send')} className={`flex flex-col items-center space-y-1 ${activeTab === 'send' ? 'text-red-600' : 'text-gray-400'}`}>
                            <div className={`p-2 rounded-full -mt-6 shadow-lg border-4 border-gray-50 ${activeTab === 'send' ? 'bg-red-600 text-white' : 'bg-white text-red-500'}`}>
                                <Send className="w-6 h-6 ml-0.5" />
                            </div>
                            <span className="text-xs scale-90">å‘çº¢åŒ…</span>
                        </button>
                        <button onClick={() => setActiveTab('history')} className={`flex flex-col items-center space-y-1 ${activeTab === 'history' ? 'text-red-600' : 'text-gray-400'}`}>
                            <History className="w-6 h-6" />
                            <span className="text-xs scale-90">è®°å½•</span>
                        </button>
                    </div>

                    {/* æ¡Œé¢å¯¼èˆª */}
                    <div className="hidden md:flex fixed bottom-8 left-1/2 transform -translate-x-1/2 bg-white px-6 py-3 rounded-full shadow-xl border border-gray-200 z-40 space-x-8">
                        <button onClick={() => setActiveTab('home')} className={`flex items-center space-x-2 font-bold transition ${activeTab === 'home' ? 'text-red-600' : 'text-gray-400 hover:text-gray-600'}`}>
                            <Gift /> <span>æŠ¢çº¢åŒ…</span>
                        </button>
                        <div className="w-[1px] bg-gray-200 h-6"></div>
                        <button onClick={() => setActiveTab('send')} className={`flex items-center space-x-2 font-bold transition ${activeTab === 'send' ? 'text-red-600' : 'text-gray-400 hover:text-gray-600'}`}>
                            <Send /> <span>å‘çº¢åŒ…</span>
                        </button>
                        <div className="w-[1px] bg-gray-200 h-6"></div>
                        <button onClick={() => setActiveTab('history')} className={`flex items-center space-x-2 font-bold transition ${activeTab === 'history' ? 'text-red-600' : 'text-gray-400 hover:text-gray-600'}`}>
                            <History /> <span>è®°å½•</span>
                        </button>
                    </div>

                    {/* å£ä»¤è¾“å…¥å¼¹çª— */}
                    {selectedPacket && (
                        <div className="fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black bg-opacity-50 backdrop-blur-sm animate-fade-in">
                            <div className="bg-white w-full max-w-sm rounded-2xl shadow-2xl overflow-hidden relative animate-scale-up">
                                <button 
                                    onClick={() => setSelectedPacket(null)}
                                    className="absolute top-4 right-4 text-gray-400 hover:text-gray-600"
                                >
                                    <XCircle className="w-6 h-6" />
                                </button>
                                <div className="bg-red-500 p-8 text-center text-white">
                                    <div className="w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-4 backdrop-blur-md">
                                        <Lock className="w-8 h-8" />
                                    </div>
                                    <h3 className="text-xl font-bold">è¿™æ˜¯ä¸€ä¸ªå£ä»¤çº¢åŒ…</h3>
                                    <p className="text-red-100 text-sm mt-1">è¾“å…¥æ­£ç¡®çš„å£ä»¤å³å¯é¢†å–</p>
                                </div>
                                <div className="p-6">
                                    <input 
                                        type="text" 
                                        placeholder="è¯·è¾“å…¥å£ä»¤"
                                        value={claimPassword}
                                        onChange={(e) => setClaimPassword(e.target.value)}
                                        className="w-full text-center text-lg border-b-2 border-gray-200 pb-2 mb-6 focus:border-red-500 focus:outline-none transition"
                                        onKeyPress={(e) => {
                                            if (e.key === 'Enter') {
                                                handleClaimPacket(selectedPacket.id, claimPassword);
                                            }
                                        }}
                                    />
                                    <button 
                                        onClick={() => handleClaimPacket(selectedPacket.id, claimPassword)}
                                        disabled={loading}
                                        className="w-full bg-red-600 text-white py-3 rounded-xl font-bold hover:bg-red-700 transition shadow-lg shadow-red-200 disabled:bg-gray-400"
                                    >
                                        {loading ? 'å¼€å¯ä¸­...' : 'å¼€çº¢åŒ…'}
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* é’±åŒ…é€‰æ‹©å¼¹çª— */}
                    {showWalletModal && (
                        <div className="fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black bg-opacity-50 backdrop-blur-sm animate-fade-in">
                            <div className="bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden relative animate-scale-up">
                                <button 
                                    onClick={() => setShowWalletModal(false)}
                                    className="absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10"
                                >
                                    <XCircle className="w-6 h-6" />
                                </button>
                                
                                <div className="bg-gradient-to-r from-red-600 to-red-500 p-8 text-center text-white">
                                    <div className="w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-4 backdrop-blur-md">
                                        <Wallet />
                                    </div>
                                    <h3 className="text-2xl font-bold">é€‰æ‹©é’±åŒ…</h3>
                                    <p className="text-red-100 text-sm mt-2">é€‰æ‹©ä½ æƒ³è¿æ¥çš„é’±åŒ…ç±»å‹</p>
                                </div>
                                
                                <div className="p-6 space-y-3">
                                    {detectWallets().map((wallet) => (
                                        <button
                                            key={wallet.id}
                                            onClick={() => connectWithWallet(wallet.id)}
                                            disabled={loading}
                                            className="wallet-option w-full flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 rounded-xl border border-gray-200 transition disabled:opacity-50 disabled:cursor-not-allowed"
                                        >
                                            <div className="flex items-center space-x-3">
                                                <span className="text-3xl">{wallet.icon}</span>
                                                <div className="text-left">
                                                    <p className="font-bold text-gray-800">{wallet.name}</p>
                                                    <p className="text-xs text-gray-500">
                                                        {wallet.id === 'walletconnect' ? 'æ‰«ç è¿æ¥ç§»åŠ¨é’±åŒ…' : 'æµè§ˆå™¨æ‰©å±•'}
                                                    </p>
                                                </div>
                                            </div>
                                            <ChevronRight className="text-gray-400" />
                                        </button>
                                    ))}
                                </div>
                                
                                <div className="px-6 pb-6">
                                    <p className="text-xs text-gray-500 text-center">
                                        æ²¡æœ‰é’±åŒ…ï¼Ÿ
                                        <a 
                                            href="https://metamask.io/download/" 
                                            target="_blank" 
                                            rel="noopener noreferrer"
                                            className="text-red-600 hover:underline ml-1"
                                        >
                                            å®‰è£… MetaMask
                                        </a>
                                    </p>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<MonadRedPacket />, document.getElementById('root'));
    </script>
</body>
</html>
